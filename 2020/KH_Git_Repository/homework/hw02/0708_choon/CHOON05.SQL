-- 문제5
-- 입학 정원이 20명 이상 30명 이하인 학과들의 학과 이름과 계열을 출력

-- 1. 먼저 TB_DEPARTMENT와 TB_STUDENT를 INNER JOIN
-- 중복키 DEPARTMENT_NO
SELECT *
FROM TB_DEPARTMENT, TB_STUDENT
WHERE TB_DEPARTMENT.DEPARTMENT_NO= TB_STUDENT.DEPARTMENT_NO;

-- 2. 입학정원: TB_DEPARTMENT.CAPACITY
-- 아래 쿼리문 실행결과-> DEPARTMENT_NAME이 중복된다.
SELECT TB_DEPARTMENT.DEPARTMENT_NAME , TB_DEPARTMENT.CATEGORY
FROM TB_DEPARTMENT, TB_STUDENT
WHERE TB_DEPARTMENT.DEPARTMENT_NO= TB_STUDENT.DEPARTMENT_NO
    AND TB_DEPARTMENT.CAPACITY BETWEEN 20 AND 30 -- 입학정우너이 20명이상 30명 이하
ORDER BY TB_DEPARTMENT.DEPARTMENT_NAME; --학과이름 오름차순 정렬


-- 3. 학과이름의 중복을 막기위해서 "DEPARTMENT_NAME"만 DISTINCT시킴.
SELECT DISTINCT TB_DEPARTMENT.DEPARTMENT_NAME , TB_DEPARTMENT.CATEGORY
FROM TB_DEPARTMENT, TB_STUDENT
WHERE TB_DEPARTMENT.DEPARTMENT_NO= TB_STUDENT.DEPARTMENT_NO
    AND TB_DEPARTMENT.CAPACITY BETWEEN 20 AND 30 -- 입학정우너이 20명이상 30명 이하
ORDER BY TB_DEPARTMENT.DEPARTMENT_NAME; --학과이름 오름차순 정렬


-- ANSWER
SELECT DISTINCT TB_DEPARTMENT.DEPARTMENT_NAME , TB_DEPARTMENT.CATEGORY
FROM TB_DEPARTMENT, TB_STUDENT
WHERE TB_DEPARTMENT.DEPARTMENT_NO= TB_STUDENT.DEPARTMENT_NO
    AND TB_DEPARTMENT.CAPACITY BETWEEN 20 AND 30 -- 입학정우너이 20명이상 30명 이하
ORDER BY TB_DEPARTMENT.DEPARTMENT_NAME; --학과이름 오름차순 정렬
