-- KH_연습문제
-- 1. 70년대 생(1970~1979)중 여자이면서, 전씨인 사원의
-- 이름과 주민번호, 부서명, 직급을 조회한다.

-- ANSI
-- 1) EMPLOYEE, DEPARTMENT, JOB 테이블 조인
SELECT EMP_NAME 이름, EMP_NO 주민번호, DEPT_TITLE 부서명, JOB_NAME 직급
FROM EMPLOYEE
    JOIN DEPARTMENT ON(DEPT_CODE=DEPT_ID)
    JOIN JOB USING(JOB_CODE);


-- 2) 70년대생이고, 여자이고, 전씨인 사원 구하기
SELECT EMP_NAME 이름
FROM EMPLOYEE
WHERE TO_NUMBER(SUBSTR(EMP_NO,1,2)) BETWEEN 70 AND 79 --70년대생
      AND SUBSTR(EMP_NO,8,1)=2 --여자
      AND EMP_NAME LIKE '전%';

-- 3) ANSWER
SELECT EMP_NAME 이름, EMP_NO 주민번호, DEPT_TITLE "부서 명", JOB_NAME 직급
FROM EMPLOYEE
        JOIN DEPARTMENT ON (DEPT_CODE=DEPT_ID)
        JOIN JOB USING(JOB_CODE) --동일한컬럼
WHERE TO_NUMBER(SUBSTR(EMP_NO,1,2)) BETWEEN 70 AND 79 --70년대생
     AND SUBSTR(EMP_NO, 8,1)=2 --여자
     AND EMP_NAME LIKE '전%'; --전씨
