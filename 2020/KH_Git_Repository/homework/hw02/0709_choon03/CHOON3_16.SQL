-- 문제 16. 환경조경학과 전공과목들의 과목별 평점을 파악할 수 있는 SQL문을 작성하시오.
-- 1) 환경조경학과 전공과목을 알아보자.
SELECT CLASS_NO, CLASS_NAME, CLASS_TYPE
FROM TB_CLASS
        JOIN TB_DEPARTMENT USING(DEPARTMENT_NO)
WHERE DEPARTMENT_NAME='환경조경학과'
        AND CLASS_TYPE LIKE '전공%';


-- 2) CLASS_NO, CLASS_NAME을 기준으로 학점 평균을 구한다.
SELECT CLASS_NO, CLASS_NAME, AVG(POINT)
FROM TB_CLASS
    JOIN TB_DEPARTMENT USING(DEPARTMENT_NO) --학과테이블과 INNER JOIN (DEPARTMENT_NO 중복)
    JOIN TB_GRADE USING(CLASS_NO) --성적테이블과 INNSER JOIN(CLASS_NO 중복)
GROUP BY CLASS_NO, CLASS_NAME;


-- ANSWER
-- 3) 1)+2)
SELECT CLASS_NO, CLASS_NAME, TRUNC(AVG(POINT),8)
FROM TB_CLASS
        JOIN TB_DEPARTMENT USING(DEPARTMENT_NO)
        JOIN TB_GRADE USING(CLASS_NO)
WHERE DEPARTMENT_NAME='환경조경학과'
        AND CLASS_TYPE LIKE '전공%'
GROUP BY CLASS_NO, CLASS_NAME
ORDER BY CLASS_NO; --CLASS_NO 오름차순
